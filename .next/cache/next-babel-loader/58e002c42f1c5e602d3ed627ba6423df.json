{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/milosdzeletovic/projects/me/dnd-armory/dnd-armory-next/components/modals/update-subclass/index.tsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { IoIosClose } from 'react-icons/io';\nimport { useForm } from 'react-hook-form';\nimport { useModal } from '../../../context/modal';\nimport { subclassTitle } from '../../../utils/character';\nimport SelectInput from '../../form/select-input';\nimport SubmitButton from '../../form/submit-button';\nimport Loader from '../../layout/loader';\nimport { useSubclassesQuery, useAddSubclassMutation } from '../../../generated/graphql';\nimport styles from './styles.module.css';\n\nvar UpdateSubclass = function UpdateSubclass(_ref) {\n  _s();\n\n  var characterId = _ref.characterId,\n      originalValue = _ref.originalValue,\n      klassName = _ref.klassName;\n\n  var _useModal = useModal(),\n      closeModal = _useModal.closeModal;\n\n  var _useSubclassesQuery = useSubclassesQuery({\n    variables: {\n      klassName: klassName\n    }\n  }),\n      _useSubclassesQuery2 = _slicedToArray(_useSubclassesQuery, 1),\n      subclassesResult = _useSubclassesQuery2[0];\n\n  var _useAddSubclassMutati = useAddSubclassMutation(),\n      _useAddSubclassMutati2 = _slicedToArray(_useAddSubclassMutati, 2),\n      addSubclass = _useAddSubclassMutati2[1];\n\n  var _useForm = useForm({\n    mode: 'onSubmit',\n    defaultValues: {\n      subclass: originalValue.id ? originalValue : null\n    }\n  }),\n      handleSubmit = _useForm.handleSubmit,\n      errors = _useForm.errors,\n      control = _useForm.control,\n      watch = _useForm.watch;\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(values) {\n      var subclassId, subclassResult;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              closeModal();\n              subclassId = values.subclass.value;\n              _context.next = 4;\n              return addSubclass({\n                id: characterId,\n                subclassId: subclassId\n              });\n\n            case 4:\n              subclassResult = _context.sent;\n\n              if (!subclassResult.error) {\n                _context.next = 8;\n                break;\n              }\n\n              console.log('An error occured. Handle it later.');\n              return _context.abrupt(\"return\");\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function onSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  if (subclassesResult.fetching) {\n    return __jsx(\"div\", {\n      className: \"m-8\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 7\n      }\n    }, __jsx(Loader, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }\n    }));\n  }\n\n  if (subclassesResult.error) {\n    var _subclassesResult$err;\n\n    console.log(subclassesResult.error);\n    return __jsx(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 7\n      }\n    }, (subclassesResult === null || subclassesResult === void 0 ? void 0 : (_subclassesResult$err = subclassesResult.error) === null || _subclassesResult$err === void 0 ? void 0 : _subclassesResult$err.message) || 'Unknown error occurred');\n  }\n\n  var subclasses = subclassesResult.data.subclasses;\n\n  if (!subclasses.length) {\n    return __jsx(\"div\", {\n      className: styles.container,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 7\n      }\n    }, __jsx(\"div\", {\n      className: styles.header,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }\n    }, __jsx(\"div\", {\n      className: styles.headerTitle,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 11\n      }\n    }, __jsx(\"h1\", {\n      className: styles.heading,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }\n    }, subclassTitle[klassName])), __jsx(\"button\", {\n      className: styles.close,\n      onClick: closeModal,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 11\n      }\n    }, __jsx(IoIosClose, {\n      size: 25,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 13\n      }\n    }))), __jsx(\"div\", {\n      className: \"p-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }\n    }, __jsx(\"p\", {\n      className: \"my-2 text-left\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 11\n      }\n    }, klassName, \" not supported yet. Working on it...\")));\n  }\n\n  return __jsx(\"div\", {\n    className: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: styles.header,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: styles.headerTitle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 9\n    }\n  }, __jsx(\"h1\", {\n    className: styles.heading,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 11\n    }\n  }, subclassTitle[klassName])), __jsx(\"button\", {\n    className: styles.close,\n    onClick: closeModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 9\n    }\n  }, __jsx(IoIosClose, {\n    size: 25,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 11\n    }\n  }))), __jsx(\"div\", {\n    className: styles.formContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }\n  }, __jsx(\"form\", {\n    className: styles.form,\n    onSubmit: handleSubmit(onSubmit),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 9\n    }\n  }, __jsx(SelectInput, {\n    control: control,\n    value: watch('subclass'),\n    errors: errors,\n    label: '',\n    name: \"subclass\",\n    options: subclasses.map(function (el) {\n      return {\n        value: el.id,\n        label: el.name\n      };\n    }),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 11\n    }\n  }), __jsx(\"div\", {\n    className: styles.submitContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 11\n    }\n  }, __jsx(SubmitButton, {\n    text: \"Submit\",\n    loading: false,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }\n  })))));\n};\n\n_s(UpdateSubclass, \"1xxcQX+c3B4h0SL6m+Ad5ctScWk=\", false, function () {\n  return [useModal, useSubclassesQuery, useAddSubclassMutation, useForm];\n});\n\n_c = UpdateSubclass;\nexport { UpdateSubclass as default };\n\nvar _c;\n\n$RefreshReg$(_c, \"UpdateSubclass\");","map":{"version":3,"sources":["/Users/milosdzeletovic/projects/me/dnd-armory/dnd-armory-next/components/modals/update-subclass/index.tsx"],"names":["React","IoIosClose","useForm","useModal","subclassTitle","SelectInput","SubmitButton","Loader","useSubclassesQuery","useAddSubclassMutation","styles","UpdateSubclass","characterId","originalValue","klassName","closeModal","variables","subclassesResult","addSubclass","mode","defaultValues","subclass","id","handleSubmit","errors","control","watch","onSubmit","values","subclassId","value","subclassResult","error","console","log","fetching","message","subclasses","data","length","container","header","headerTitle","heading","close","formContainer","form","map","el","label","name","submitContainer","default"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { IoIosClose } from 'react-icons/io'\nimport { useForm } from 'react-hook-form'\n\nimport { useModal } from '../../../context/modal'\nimport { subclassTitle } from '../../../utils/character'\nimport SelectInput from '../../form/select-input'\nimport SubmitButton from '../../form/submit-button'\nimport Loader from '../../layout/loader'\n\nimport {\n  Character,\n  useSubclassesQuery,\n  useAddSubclassMutation,\n} from '../../../generated/graphql'\n\nimport styles from './styles.module.css'\n\ntype FormValues = Record<\n  string,\n  {\n    value: string\n    label: string\n  }\n>\n\ntype Props = {\n  characterId: Character['id']\n  originalValue: {\n    id: string | undefined\n    label: string | undefined\n  }\n  klassName: string\n}\n\nconst UpdateSubclass: React.FC<Props> = ({\n  characterId,\n  originalValue,\n  klassName,\n}) => {\n  const { closeModal } = useModal()\n\n  const [subclassesResult] = useSubclassesQuery({\n    variables: {\n      klassName,\n    },\n  })\n\n  const [, addSubclass] = useAddSubclassMutation()\n\n  const { handleSubmit, errors, control, watch } = useForm<FormValues>({\n    mode: 'onSubmit',\n    defaultValues: {\n      subclass: originalValue.id ? originalValue : null,\n    },\n  })\n\n  const onSubmit = async (values: FormValues) => {\n    closeModal()\n\n    const subclassId = (values.subclass as any).value\n\n    const subclassResult = await addSubclass({\n      id: characterId,\n      subclassId,\n    })\n\n    if (subclassResult.error) {\n      console.log('An error occured. Handle it later.')\n      return\n    }\n  }\n\n  if (subclassesResult.fetching) {\n    return (\n      <div className=\"m-8\">\n        <Loader />\n      </div>\n    )\n  }\n\n  if (subclassesResult.error) {\n    console.log(subclassesResult.error)\n    return (\n      <div>{subclassesResult?.error?.message || 'Unknown error occurred'}</div>\n    )\n  }\n\n  const { subclasses } = subclassesResult.data\n\n  if (!subclasses.length) {\n    return (\n      <div className={styles.container}>\n        <div className={styles.header}>\n          <div className={styles.headerTitle}>\n            {/* {icons[type]} */}\n            <h1 className={styles.heading}>{subclassTitle[klassName]}</h1>\n          </div>\n          <button className={styles.close} onClick={closeModal}>\n            <IoIosClose size={25} />\n          </button>\n        </div>\n        <div className=\"p-4\">\n          <p className=\"my-2 text-left\">\n            {klassName} not supported yet. Working on it...\n          </p>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.header}>\n        <div className={styles.headerTitle}>\n          {/* {icons[type]} */}\n          <h1 className={styles.heading}>{subclassTitle[klassName]}</h1>\n        </div>\n        <button className={styles.close} onClick={closeModal}>\n          <IoIosClose size={25} />\n        </button>\n      </div>\n\n      <div className={styles.formContainer}>\n        <form className={styles.form} onSubmit={handleSubmit(onSubmit)}>\n          <SelectInput\n            control={control}\n            value={watch('subclass')}\n            errors={errors}\n            label={''}\n            name=\"subclass\"\n            options={subclasses.map((el) => {\n              return {\n                value: el.id,\n                label: el.name,\n              }\n            })}\n          />\n\n          <div className={styles.submitContainer}>\n            <SubmitButton text=\"Submit\" loading={false} />\n          </div>\n        </form>\n      </div>\n    </div>\n  )\n}\n\nexport { UpdateSubclass as default }\n"]},"metadata":{},"sourceType":"module"}