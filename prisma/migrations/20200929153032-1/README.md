# Migration `20200929153032-1`

This migration has been generated by Milos at 9/29/2020, 5:30:32 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."SubClass" (
"id" text   NOT NULL ,
"name" text   NOT NULL ,
"description" text   NOT NULL ,
"spellCastingModifier" text   ,
"klassId" text   NOT NULL ,
"source" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Spell" (
"id" text   NOT NULL ,
"name" text   NOT NULL ,
"level" integer   NOT NULL ,
"castingTime" text   NOT NULL ,
"range" text   NOT NULL ,
"components" text   NOT NULL ,
"duration" text   NOT NULL ,
"concentration" boolean   NOT NULL ,
"ritual" boolean   NOT NULL ,
"school" text   NOT NULL ,
"description" text   NOT NULL ,
"klasses" text   NOT NULL ,
"damageEffect" text   NOT NULL ,
"attackSave" text   NOT NULL ,
"material" text   ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Klass" (
"id" text   NOT NULL ,
"name" text   NOT NULL ,
"description" text   NOT NULL ,
"hitDie" text   NOT NULL ,
"hitPointsAt1st" text   NOT NULL ,
"primaryAbility" text []  ,
"savingThrows" text []  ,
"armor" text []  ,
"weapons" text []  ,
"tools" text   ,
"skills" text []  ,
"spellCastingModifier" text   ,
"proficientSkillsAt1st" integer   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Skill" (
"id" text   NOT NULL ,
"name" text   NOT NULL ,
"ability" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Character" (
"id" text   NOT NULL ,
"name" text   NOT NULL ,
"level" integer   NOT NULL DEFAULT 1,
"race" text   NOT NULL ,
"klassId" text   NOT NULL ,
"alignment" text   NOT NULL ,
"armorClass" integer   NOT NULL DEFAULT 10,
"hitPoints" integer   NOT NULL DEFAULT 10,
"maxHitPoints" integer   NOT NULL DEFAULT 10,
"gold" integer   ,
"inspiration" boolean   NOT NULL DEFAULT false,
"strength" integer   NOT NULL DEFAULT 10,
"dexterity" integer   NOT NULL DEFAULT 10,
"constitution" integer   NOT NULL DEFAULT 10,
"intelligence" integer   NOT NULL DEFAULT 10,
"wisdom" integer   NOT NULL DEFAULT 10,
"charisma" integer   NOT NULL DEFAULT 10,
"userId" text   NOT NULL ,
"subclassId" text   ,
"spellSlots" text   ,
"speed" integer   NOT NULL DEFAULT 30,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."accounts" (
"id" text   NOT NULL ,
"compound_id" text   NOT NULL ,
"user_id" integer   NOT NULL ,
"provider_type" text   NOT NULL ,
"provider_id" text   NOT NULL ,
"provider_account_id" text   NOT NULL ,
"refresh_token" text   ,
"access_token" text   ,
"access_token_expires" timestamp(3)   ,
"created_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updated_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."sessions" (
"id" text   NOT NULL ,
"user_id" integer   NOT NULL ,
"expires" timestamp(3)   NOT NULL ,
"session_token" text   NOT NULL ,
"access_token" text   NOT NULL ,
"created_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updated_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."users" (
"id" text   NOT NULL ,
"name" text   ,
"email" text   ,
"email_verified" timestamp(3)   ,
"image" text   ,
"created_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updated_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."verification_requests" (
"id" text   NOT NULL ,
"identifier" text   NOT NULL ,
"token" text   NOT NULL ,
"expires" timestamp(3)   NOT NULL ,
"created_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updated_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."_KnownSpells" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE TABLE "public"."_PreparedSpells" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE TABLE "public"."_CharacterToSkill" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE UNIQUE INDEX "SubClass.name_unique" ON "public"."SubClass"("name")

CREATE UNIQUE INDEX "Spell.name_unique" ON "public"."Spell"("name")

CREATE UNIQUE INDEX "Klass.name_unique" ON "public"."Klass"("name")

CREATE UNIQUE INDEX "Skill.name_unique" ON "public"."Skill"("name")

CREATE UNIQUE INDEX "accounts.compound_id_unique" ON "public"."accounts"("compound_id")

CREATE INDEX "providerAccountId" ON "public"."accounts"("provider_account_id")

CREATE INDEX "providerId" ON "public"."accounts"("provider_id")

CREATE INDEX "userId" ON "public"."accounts"("user_id")

CREATE UNIQUE INDEX "sessions.session_token_unique" ON "public"."sessions"("session_token")

CREATE UNIQUE INDEX "sessions.access_token_unique" ON "public"."sessions"("access_token")

CREATE UNIQUE INDEX "users.email_unique" ON "public"."users"("email")

CREATE UNIQUE INDEX "verification_requests.token_unique" ON "public"."verification_requests"("token")

CREATE UNIQUE INDEX "_KnownSpells_AB_unique" ON "public"."_KnownSpells"("A", "B")

CREATE INDEX "_KnownSpells_B_index" ON "public"."_KnownSpells"("B")

CREATE UNIQUE INDEX "_PreparedSpells_AB_unique" ON "public"."_PreparedSpells"("A", "B")

CREATE INDEX "_PreparedSpells_B_index" ON "public"."_PreparedSpells"("B")

CREATE UNIQUE INDEX "_CharacterToSkill_AB_unique" ON "public"."_CharacterToSkill"("A", "B")

CREATE INDEX "_CharacterToSkill_B_index" ON "public"."_CharacterToSkill"("B")

ALTER TABLE "public"."SubClass" ADD FOREIGN KEY ("klassId")REFERENCES "public"."Klass"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Character" ADD FOREIGN KEY ("klassId")REFERENCES "public"."Klass"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Character" ADD FOREIGN KEY ("userId")REFERENCES "public"."users"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Character" ADD FOREIGN KEY ("subclassId")REFERENCES "public"."SubClass"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."_KnownSpells" ADD FOREIGN KEY ("A")REFERENCES "public"."Character"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_KnownSpells" ADD FOREIGN KEY ("B")REFERENCES "public"."Spell"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_PreparedSpells" ADD FOREIGN KEY ("A")REFERENCES "public"."Character"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_PreparedSpells" ADD FOREIGN KEY ("B")REFERENCES "public"."Spell"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_CharacterToSkill" ADD FOREIGN KEY ("A")REFERENCES "public"."Character"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_CharacterToSkill" ADD FOREIGN KEY ("B")REFERENCES "public"."Skill"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200929153032-1
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,148 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model SubClass {
+  id                   String      @default(cuid()) @id
+  name                 String      @unique
+  description          String
+  spellCastingModifier String?
+  klass                Klass       @relation(fields: [klassId], references: [id])
+  klassId              String
+  Character            Character[]
+  source               String
+}
+
+model Spell {
+  id                 String      @default(cuid()) @id
+  name               String      @unique
+  level              Int
+  castingTime        String
+  range              String
+  components         String
+  duration           String
+  concentration      Boolean
+  ritual             Boolean
+  school             String
+  description        String
+  klasses            String
+  damageEffect       String
+  attackSave         String
+  material           String?
+  characters         Character[] @relation("KnownSpells", references: [id])
+  charactersPrepared Character[] @relation("PreparedSpells", references: [id])
+}
+
+model Klass {
+  id                    String      @default(cuid()) @id
+  name                  String      @unique
+  description           String
+  hitDie                String
+  hitPointsAt1st        String
+  primaryAbility        String[]
+  savingThrows          String[]
+  armor                 String[]
+  weapons               String[]
+  tools                 String?
+  skills                String[]
+  spellCastingModifier  String?
+  proficientSkillsAt1st Int
+  characters            Character[]
+  subClasses            SubClass[]
+}
+
+model Skill {
+  id         String      @default(cuid()) @id
+  name       String      @unique
+  ability    String
+  characters Character[] @relation(references: [id])
+}
+
+model Character {
+  id             String    @default(cuid()) @id
+  name           String
+  level          Int       @default(1)
+  race           String
+  klass          Klass     @relation(fields: [klassId], references: [id])
+  klassId        String
+  alignment      String
+  armorClass     Int       @default(10)
+  hitPoints      Int       @default(10)
+  maxHitPoints   Int       @default(10)
+  gold           Int?
+  inspiration    Boolean   @default(false)
+  strength       Int       @default(10)
+  dexterity      Int       @default(10)
+  constitution   Int       @default(10)
+  intelligence   Int       @default(10)
+  wisdom         Int       @default(10)
+  charisma       Int       @default(10)
+  user           User      @relation(fields: [userId], references: [id])
+  userId         String
+  spells         Spell[]   @relation("KnownSpells")
+  preparedSpells Spell[]   @relation("PreparedSpells")
+  skills         Skill[]
+  subclass       SubClass? @relation(fields: [subclassId], references: [id])
+  subclassId     String?
+  spellSlots     String?
+  speed          Int       @default(30)
+}
+
+model Account {
+  id                 String    @default(cuid()) @id
+  compoundId         String    @unique @map(name: "compound_id")
+  userId             Int       @map(name: "user_id")
+  providerType       String    @map(name: "provider_type")
+  providerId         String    @map(name: "provider_id")
+  providerAccountId  String    @map(name: "provider_account_id")
+  refreshToken       String?   @map(name: "refresh_token")
+  accessToken        String?   @map(name: "access_token")
+  accessTokenExpires DateTime? @map(name: "access_token_expires")
+  createdAt          DateTime  @default(now()) @map(name: "created_at")
+  updatedAt          DateTime  @default(now()) @map(name: "updated_at")
+  @@index([providerAccountId], name: "providerAccountId")
+  @@index([providerId], name: "providerId")
+  @@index([userId], name: "userId")
+  @@map(name: "accounts")
+}
+
+model Session {
+  id           String   @default(cuid()) @id
+  userId       Int      @map(name: "user_id")
+  expires      DateTime
+  sessionToken String   @unique @map(name: "session_token")
+  accessToken  String   @unique @map(name: "access_token")
+  createdAt    DateTime @default(now()) @map(name: "created_at")
+  updatedAt    DateTime @default(now()) @map(name: "updated_at")
+  @@map(name: "sessions")
+}
+
+model User {
+  id            String      @default(cuid()) @id
+  name          String?
+  email         String?     @unique
+  emailVerified DateTime?   @map(name: "email_verified")
+  image         String?
+  createdAt     DateTime    @default(now()) @map(name: "created_at")
+  updatedAt     DateTime    @default(now()) @map(name: "updated_at")
+  characters    Character[]
+  @@map(name: "users")
+}
+
+model VerificationRequest {
+  id         String   @default(cuid()) @id
+  identifier String
+  token      String   @unique
+  expires    DateTime
+  createdAt  DateTime @default(now()) @map(name: "created_at")
+  updatedAt  DateTime @default(now()) @map(name: "updated_at")
+  @@map(name: "verification_requests")
+}
```


