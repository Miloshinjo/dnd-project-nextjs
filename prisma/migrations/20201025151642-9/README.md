# Migration `20201025151642-9`

This migration has been generated by Milos at 10/25/2020, 4:16:42 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Spell" ADD COLUMN "magicItemId" integer   

CREATE TABLE "public"."MagicItem" (
"id" SERIAL,
"name" text   NOT NULL ,
"description" text   NOT NULL ,
"type" text   NOT NULL ,
"rarity" text   NOT NULL ,
"attunement" boolean   NOT NULL ,
"magicBonus" integer   ,
"weaponType" text   ,
"armorType" text   ,
"characterId" integer   ,
PRIMARY KEY ("id")
)

ALTER TABLE "public"."MagicItem" ADD FOREIGN KEY ("characterId")REFERENCES "public"."Character"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Spell" ADD FOREIGN KEY ("magicItemId")REFERENCES "public"."MagicItem"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201020202158-8..20201025151642-9
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -37,8 +37,10 @@
   attackSave         String
   material           String?
   characters         Character[] @relation("KnownSpells", references: [id])
   charactersPrepared Character[] @relation("PreparedSpells", references: [id])
+  MagicItem          MagicItem?  @relation(fields: [magicItemId], references: [id])
+  magicItemId        Int?
 }
 model Klass {
   id                    Int         @id @default(autoincrement())
@@ -65,40 +67,56 @@
   characters Character[] @relation(references: [id])
 }
 model Character {
-  id              Int       @id @default(autoincrement())
+  id              Int         @id @default(autoincrement())
   name            String
-  level           Int       @default(1)
+  level           Int         @default(1)
   race            String
-  klass           Klass     @relation(fields: [klassId], references: [id])
+  klass           Klass       @relation(fields: [klassId], references: [id])
   klassId         Int
   alignment       String
-  armorClass      Int       @default(10)
-  hitPoints       Int       @default(10)
-  maxHitPoints    Int       @default(10)
+  armorClass      Int         @default(10)
+  hitPoints       Int         @default(10)
+  maxHitPoints    Int         @default(10)
   gold            Int?
-  inspiration     Boolean   @default(false)
-  strength        Int       @default(10)
-  dexterity       Int       @default(10)
-  constitution    Int       @default(10)
-  intelligence    Int       @default(10)
-  wisdom          Int       @default(10)
-  charisma        Int       @default(10)
-  user            User      @relation(fields: [userId], references: [id])
+  inspiration     Boolean     @default(false)
+  strength        Int         @default(10)
+  dexterity       Int         @default(10)
+  constitution    Int         @default(10)
+  intelligence    Int         @default(10)
+  wisdom          Int         @default(10)
+  charisma        Int         @default(10)
+  user            User        @relation(fields: [userId], references: [id])
   userId          Int
-  spells          Spell[]   @relation("KnownSpells")
-  preparedSpells  Spell[]   @relation("PreparedSpells")
+  spells          Spell[]     @relation("KnownSpells")
+  preparedSpells  Spell[]     @relation("PreparedSpells")
   skills          Skill[]
-  subclass        SubClass? @relation(fields: [subclassId], references: [id])
+  magicItems      MagicItem[]
+  subclass        SubClass?   @relation(fields: [subclassId], references: [id])
   subclassId      Int?
   spellSlots      String?
   klassAbilityOne String?
-  speed           Int       @default(30)
+  speed           Int         @default(30)
   arcaneWard      Int?
   arcaneWardMax   Int?
 }
+model MagicItem {
+  id             Int        @id @default(autoincrement())
+  name           String
+  description    String
+  type           String
+  rarity         String
+  attunement     Boolean
+  magicBonus     Int?
+  weaponType     String?
+  armorType      String?
+  attachedSpells Spell[]
+  Character      Character? @relation(fields: [characterId], references: [id])
+  characterId    Int?
+}
+
 model Account {
   id                 Int       @id @default(autoincrement())
   compoundId         String    @unique @map(name: "compound_id")
   userId             Int       @map(name: "user_id")
```


